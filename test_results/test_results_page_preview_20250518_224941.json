[
  {
    "name": "page_preview.test_page_preview_breaks.py",
    "passed": false,
    "message": "Test failed with return code 3221226505",
    "details": "STDOUT:\n2025-05-18 22:49:24,235 - INFO - Logging to file: C:\\Users\\joshd\\.markdown_pdf_logs\\markdown_pdf_debug_20250518_224924.log\njs: No pages found for zoom operations\njs: Found 0 pages, current page: 1\njs: Found 0 pages, current page: 1\njs: Page loaded, checking for explicit page breaks\njs: Found 2 explicit page breaks\njs: Page loaded, checking for explicit page breaks\njs: Found 2 explicit page breaks\njs: Created pages container\njs: No pages found, creating one\njs: Found 1 pages\njs: Page 1 missing page number, adding it\njs: Document ready for zoom operations, found 1 pages\njs: Page load verification: [object Object]\njs: Found 1 pages\njs: Page count: 1 of 1\njs: Found 1 pages during verification\njs: Document ready for zoom operations, found 1 pages\njs warning: Invalid page width, using default: 210mm\njs: Calculated zoom factor for fit to width: 1.4160151324085748 View width: 1182 Page width: 793\njs: Page load verification: [object Object]\n2025-05-18 22:49:26,799 - INFO - Debugging page layout\n2025-05-18 22:49:27,809 - INFO - Debug page layout result: None\n\n\nSTDERR:\n2025-05-18 22:49:24,254 - DEBUG - Initializing PagePreview\n2025-05-18 22:49:24,790 - DEBUG - Updating document settings\n2025-05-18 22:49:24,791 - DEBUG - Page dimensions: A4 portrait, 210mm x 297mm\n2025-05-18 22:49:24,791 - DEBUG - Margins: T:25mm R:25mm B:25mm L:25mm\n2025-05-18 22:49:24,791 - DEBUG - Verifying document settings\n2025-05-18 22:49:24,791 - DEBUG - Updating preview\n2025-05-18 22:49:24,791 - DEBUG - Cleaning up temporary files\n2025-05-18 22:49:24,791 - DEBUG - Cleaning up temporary files\n2025-05-18 22:49:24,791 - DEBUG - Removing 'Document' text from HTML content\n2025-05-18 22:49:24,791 - DEBUG - Creating JavaScript bridge\n2025-05-18 22:49:24,791 - DEBUG - Bridge object registered with web channel\n2025-05-18 22:49:24,792 - DEBUG - JavaScript bridge initialization script executed\n2025-05-18 22:49:24,792 - DEBUG - Loading HTML content\n2025-05-18 22:49:24,799 - DEBUG - Loading HTML from temporary file: C:\\Users\\joshd\\AppData\\Local\\Temp\\tmp8lgm02ho.html\n2025-05-18 22:49:24,799 - DEBUG - Creating JavaScript bridge\n2025-05-18 22:49:24,799 - DEBUG - Bridge object registered with web channel\n2025-05-18 22:49:24,799 - DEBUG - JavaScript bridge initialization script executed\n2025-05-18 22:49:24,800 - DEBUG - HTML file loaded from C:\\Users\\joshd\\AppData\\Local\\Temp\\tmp8lgm02ho.html\n2025-05-18 22:49:24,906 - DEBUG - Web view: load started\n2025-05-18 22:49:24,909 - DEBUG - Executing page setup sequence (first load: True)\n2025-05-18 22:49:24,961 - DEBUG - Zoom variables initialized: True\n2025-05-18 22:49:24,962 - DEBUG - Page ready check result: False\n2025-05-18 22:49:24,962 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 0}\n2025-05-18 22:49:24,962 - DEBUG - Updating page counter: 1 of 0\n2025-05-18 22:49:24,962 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 0}\n2025-05-18 22:49:24,962 - DEBUG - Updating page counter: 1 of 0\n2025-05-18 22:49:24,972 - DEBUG - Web view: load finished successfully\n2025-05-18 22:49:24,972 - DEBUG - Executing page setup sequence (first load: True)\n2025-05-18 22:49:24,973 - DEBUG - Page setup sequence already in progress, skipping\n2025-05-18 22:49:25,009 - DEBUG - Executing operation: remove_document_text\n2025-05-18 22:49:25,009 - DEBUG - Removing 'Document' text from page\n2025-05-18 22:49:25,010 - DEBUG - Remove Document text result: None\n2025-05-18 22:49:25,109 - DEBUG - Executing operation: apply_page_layout\n2025-05-18 22:49:25,109 - DEBUG - Applying page layout styling\n2025-05-18 22:49:25,109 - DEBUG - Page dimensions: 210mm x 297mm\n2025-05-18 22:49:25,109 - DEBUG - Margins: T:25mm R:25mm B:25mm L:25mm\n2025-05-18 22:49:25,109 - DEBUG - Body font: Arial, 11pt, 1.5\n2025-05-18 22:49:25,109 - DEBUG - Colors: text=#000000, bg=#ffffff, link=#0000ff\n2025-05-18 22:49:25,109 - DEBUG - Applying page layout with JavaScript\n2025-05-18 22:49:25,109 - DEBUG - Page layout already applied, skipping duplicate application\n2025-05-18 22:49:25,109 - DEBUG - Removing 'Document' text from page\n2025-05-18 22:49:25,111 - DEBUG - Ensure page visibility result: Created new page with content\n2025-05-18 22:49:25,112 - DEBUG - Remove Document text result: None\n2025-05-18 22:49:25,209 - DEBUG - Executing operation: check_duplicate_pages\n2025-05-18 22:49:25,209 - DEBUG - Checking page structure\n2025-05-18 22:49:25,209 - DEBUG - Page validation result: Validated 1 pages\n2025-05-18 22:49:25,290 - DEBUG - Zoom variables initialized: True\n2025-05-18 22:49:25,290 - DEBUG - Page ready check result: True\n2025-05-18 22:49:25,301 - DEBUG - Page load verification result: {'bodyContent': 10560, 'documentReady': True, 'title': 'Markdown Preview'}\n2025-05-18 22:49:25,301 - DEBUG - Page loaded correctly\n2025-05-18 22:49:25,309 - DEBUG - Executing operation: update_page_count\n2025-05-18 22:49:25,309 - DEBUG - Updating page count\n2025-05-18 22:49:25,309 - DEBUG - Requesting page count update from JavaScript\n2025-05-18 22:49:25,311 - DEBUG - Page count update result: [1, 1]\n2025-05-18 22:49:25,311 - DEBUG - Page count update result: [0, 0]\n2025-05-18 22:49:25,510 - DEBUG - Executing operation: verify_page_setup\n2025-05-18 22:49:25,510 - DEBUG - Verifying page setup\n2025-05-18 22:49:25,511 - DEBUG - Page verification result: Verified 1 pages\n2025-05-18 22:49:25,609 - DEBUG - Executing operation: setup_zoom_controls\n2025-05-18 22:49:25,609 - DEBUG - Setting up zoom controls\n2025-05-18 22:49:25,610 - DEBUG - Zoom controls setup completed\n2025-05-18 22:49:25,659 - DEBUG - Executing operation: initialize_zoom\n2025-05-18 22:49:25,659 - DEBUG - Initializing zoom manager variables\n2025-05-18 22:49:25,660 - DEBUG - Zoom variables initialized: True\n2025-05-18 22:49:25,660 - DEBUG - Page ready check result: True\n2025-05-18 22:49:25,709 - DEBUG - Executing operation: fit_to_width\n2025-05-18 22:49:25,709 - DEBUG - Fitting page width to view\n2025-05-18 22:49:25,709 - DEBUG - Fitting page width to view: 1182\njs: Invalid page width, using default: 210mm\n2025-05-18 22:49:25,710 - DEBUG - Zoom operation already in progress, skipping update_zoom(141)\n2025-05-18 22:49:25,809 - DEBUG - Executing operation: final_verification\n2025-05-18 22:49:25,809 - DEBUG - Page load verification result: {'bodyContent': 10560, 'documentReady': True, 'title': 'Markdown Preview'}\n2025-05-18 22:49:25,809 - DEBUG - Page loaded correctly\n2025-05-18 22:49:25,909 - DEBUG - Clearing setup flags\n2025-05-18 22:49:25,963 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:25,963 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:25,963 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:25,963 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:26,799 - INFO - Debugging page layout\n2025-05-18 22:49:26,799 - DEBUG - Executing JavaScript:\n\n        (function() {\n            try {\n                // Add debug class to body\n                document.body.classList.add('debug-mode');\n\n                // Add visual markers to all pages\n                var pages = document.querySelectorAll('.page');\n                console.log('Found ' + pages.length + ' pages for debugging');\n\n                for (var i = 0; i < pages.length; i++) {\n                    var page = pages[i];\n\n                    // Add debug class\n                    page.classList.add('debug-page');\n\n                    // Add page number for debugging\n                    var pageNum = document.createElement('div');\n                    pageNum.className = 'debug-page-number';\n                    pageNum.textContent = 'Page ' + (i + 1);\n                    pageNum.style.position = 'absolute';\n                    pageNum.style.top = '5px';\n                    pageNum.style.right = '5px';\n                    pageNum.style.backgroundColor = 'rgba(255, 0, 0, 0.7)';\n                    pageNum.style.color = 'white';\n                    pageNum.style.padding = '2px 5px';\n                    pageNum.style.fontSize = '12px';\n                    pageNum.style.zIndex = '1000';\n                    page.appendChild(pageNum);\n\n                    // Highlight margin box\n                    var marginBox = page.querySelector('.margin-box');\n                    if (marginBox) {\n                        marginBox.style.border = '2px dashed rgba(255, 0, 0, 0.7)';\n                        marginBox.style.backgroundColor = 'rgba(255, 0, 0, 0.05)';\n                    }\n\n                    // Log page dimensions\n                    var rect = page.getBoundingClientRect();\n                    console.log('Page ' + (i + 1) + ' dimensions: ' +\n                                rect.width + 'px x ' + rect.height + 'px');\n                }\n\n                // Log document settings\n                console.log('Document settings debug info:');\n                console.log('- Viewport width: ' + window.innerWidth + 'px');\n                console.log('- Viewport height: ' + window.innerHeight + 'px');\n                console.log('- Device pixel ratio: ' + window.devicePixelRatio);\n\n                return 'Debug markers added to ' + pages.length + ' pages';\n            } catch (e) {\n                console.error('Error in debug_page_layout:', e);\n                return 'Error: ' + e.message;\n            }\n        })();\n        \n2025-05-18 22:49:27,407 - DEBUG - Verifying page setup\n2025-05-18 22:49:27,809 - DEBUG - JavaScript execution result: None\n2025-05-18 22:49:27,809 - INFO - Debug page layout result: None\nTraceback (most recent call last):\n  File \"C:\\Projects\\markdown2pdf\\test_page_preview_breaks.py\", line 188, in update_status\n    self.preview.debug_page_breaks()\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'PagePreview' object has no attribute 'debug_page_breaks'. Did you mean: 'debug_page_layout'?\n",
    "duration": 4.069641590118408,
    "timestamp": "2025-05-18T22:49:28.174923",
    "category": "page_preview",
    "performance_metrics": {}
  },
  {
    "name": "page_preview.test_page_preview_comprehensive.py",
    "passed": true,
    "message": "Test passed",
    "details": "STDOUT:\n2025-05-18 22:49:28,324 - INFO - Logging to file: C:\\Users\\joshd\\.markdown_pdf_logs\\markdown_pdf_debug_20250518_224928.log\njs: No pages found for zoom operations\njs: Found 0 pages, current page: 1\njs: Found 0 pages, current page: 1\njs: Page loaded, checking for explicit page breaks\njs: Found 2 explicit page breaks\njs: Page loaded, checking for explicit page breaks\njs: Found 2 explicit page breaks\njs: Created pages container\njs: No pages found, creating one\njs: Found 1 pages\njs: Page 1 missing page number, adding it\njs: Document ready for zoom operations, found 1 pages\njs: Page load verification: [object Object]\njs: Found 1 pages\njs: Page count: 1 of 1\njs: Found 1 pages during verification\njs: Document ready for zoom operations, found 1 pages\njs warning: Invalid page width, using default: 210mm\njs: Calculated zoom factor for fit to width: 1.4160151324085748 View width: 1182 Page width: 793\n2025-05-18 22:49:29,828 - WARNING - Page number 3 exceeds total pages 0, setting to 0\n2025-05-18 22:49:29,830 - INFO - Debugging page layout\njs: Navigating to page 0 of 1 total pages\njs: Found 1 pages for debugging\njs: Page 1 dimensions: 4px x 4px\njs: - Viewport width: 1182px\njs: - Viewport height: 704px\n2025-05-18 22:49:30,036 - INFO - Debug page layout result: Debug markers added to 1 pages\njs: Page load verification: [object Object]\njs: Found 1 pages during verification\njs: Set zoom factor CSS variable to 1.1\njs: Applied zoom to 1 pages\njs: Set zoom factor CSS variable to 1.3\njs: Applied zoom to 1 pages\njs: Calculated zoom factor for fit to page: 1.5 View dimensions: 1182 x 704 Page dimensions: 4 x 4\njs: Calculated zoom factor for fit to page: 1.5 View dimensions: 1182 x 704 Page dimensions: 4 x 4\njs: Calculated zoom factor for fit to width: 1.5 View width: 1182 Page width: 4\n\n\nSTDERR:\n2025-05-18 22:49:28,343 - DEBUG - Initializing PagePreview\n2025-05-18 22:49:28,817 - DEBUG - Updating document settings\n2025-05-18 22:49:28,817 - DEBUG - Page dimensions: A4 portrait, 210mm x 297mm\n2025-05-18 22:49:28,817 - DEBUG - Margins: T:25mm R:25mm B:25mm L:25mm\n2025-05-18 22:49:28,817 - DEBUG - Verifying document settings\n2025-05-18 22:49:28,817 - DEBUG - Updating preview\n2025-05-18 22:49:28,818 - DEBUG - Cleaning up temporary files\n2025-05-18 22:49:28,818 - DEBUG - Cleaning up temporary files\n2025-05-18 22:49:28,818 - DEBUG - Removing 'Document' text from HTML content\n2025-05-18 22:49:28,819 - DEBUG - Creating JavaScript bridge\n2025-05-18 22:49:28,819 - DEBUG - Bridge object registered with web channel\n2025-05-18 22:49:28,819 - DEBUG - JavaScript bridge initialization script executed\n2025-05-18 22:49:28,819 - DEBUG - Loading HTML content\n2025-05-18 22:49:28,826 - DEBUG - Loading HTML from temporary file: C:\\Users\\joshd\\AppData\\Local\\Temp\\tmp_ifnan6g.html\n2025-05-18 22:49:28,826 - DEBUG - Creating JavaScript bridge\n2025-05-18 22:49:28,826 - DEBUG - Bridge object registered with web channel\n2025-05-18 22:49:28,826 - DEBUG - JavaScript bridge initialization script executed\n2025-05-18 22:49:28,827 - DEBUG - HTML file loaded from C:\\Users\\joshd\\AppData\\Local\\Temp\\tmp_ifnan6g.html\n2025-05-18 22:49:28,930 - DEBUG - Web view: load started\n2025-05-18 22:49:28,934 - DEBUG - Executing page setup sequence (first load: True)\n2025-05-18 22:49:28,994 - DEBUG - Zoom variables initialized: True\n2025-05-18 22:49:28,995 - DEBUG - Page ready check result: False\n2025-05-18 22:49:28,995 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 0}\n2025-05-18 22:49:28,996 - DEBUG - Updating page counter: 1 of 0\n2025-05-18 22:49:28,996 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 0}\n2025-05-18 22:49:28,996 - DEBUG - Updating page counter: 1 of 0\n2025-05-18 22:49:29,011 - DEBUG - Web view: load finished successfully\n2025-05-18 22:49:29,011 - DEBUG - Executing page setup sequence (first load: True)\n2025-05-18 22:49:29,011 - DEBUG - Page setup sequence already in progress, skipping\n2025-05-18 22:49:29,040 - DEBUG - Executing operation: remove_document_text\n2025-05-18 22:49:29,041 - DEBUG - Removing 'Document' text from page\n2025-05-18 22:49:29,042 - DEBUG - Remove Document text result: None\n2025-05-18 22:49:29,134 - DEBUG - Executing operation: apply_page_layout\n2025-05-18 22:49:29,134 - DEBUG - Applying page layout styling\n2025-05-18 22:49:29,134 - DEBUG - Page dimensions: 210mm x 297mm\n2025-05-18 22:49:29,134 - DEBUG - Margins: T:25mm R:25mm B:25mm L:25mm\n2025-05-18 22:49:29,135 - DEBUG - Body font: Arial, 11pt, 1.5\n2025-05-18 22:49:29,135 - DEBUG - Colors: text=#000000, bg=#ffffff, link=#0000ff\n2025-05-18 22:49:29,135 - DEBUG - Applying page layout with JavaScript\n2025-05-18 22:49:29,135 - DEBUG - Page layout already applied, skipping duplicate application\n2025-05-18 22:49:29,135 - DEBUG - Removing 'Document' text from page\n2025-05-18 22:49:29,136 - DEBUG - Ensure page visibility result: Created new page with content\n2025-05-18 22:49:29,136 - DEBUG - Remove Document text result: None\n2025-05-18 22:49:29,235 - DEBUG - Executing operation: check_duplicate_pages\n2025-05-18 22:49:29,235 - DEBUG - Checking page structure\n2025-05-18 22:49:29,235 - DEBUG - Page validation result: Validated 1 pages\n2025-05-18 22:49:29,318 - DEBUG - Zoom variables initialized: True\n2025-05-18 22:49:29,318 - DEBUG - Page ready check result: True\n2025-05-18 22:49:29,329 - DEBUG - Page load verification result: {'bodyContent': 18250, 'documentReady': True, 'title': 'Markdown Preview'}\n2025-05-18 22:49:29,329 - DEBUG - Page loaded correctly\n2025-05-18 22:49:29,335 - DEBUG - Executing operation: update_page_count\n2025-05-18 22:49:29,335 - DEBUG - Updating page count\n2025-05-18 22:49:29,335 - DEBUG - Requesting page count update from JavaScript\n2025-05-18 22:49:29,336 - DEBUG - Page count update result: [1, 1]\n2025-05-18 22:49:29,336 - DEBUG - Page count update result: [0, 0]\n2025-05-18 22:49:29,534 - DEBUG - Executing operation: verify_page_setup\n2025-05-18 22:49:29,534 - DEBUG - Verifying page setup\n2025-05-18 22:49:29,535 - DEBUG - Page verification result: Verified 1 pages\n2025-05-18 22:49:29,634 - DEBUG - Executing operation: setup_zoom_controls\n2025-05-18 22:49:29,634 - DEBUG - Setting up zoom controls\n2025-05-18 22:49:29,636 - DEBUG - Zoom controls setup completed\n2025-05-18 22:49:29,684 - DEBUG - Executing operation: initialize_zoom\n2025-05-18 22:49:29,684 - DEBUG - Initializing zoom manager variables\n2025-05-18 22:49:29,685 - DEBUG - Zoom variables initialized: True\n2025-05-18 22:49:29,685 - DEBUG - Page ready check result: True\n2025-05-18 22:49:29,734 - DEBUG - Executing operation: fit_to_width\n2025-05-18 22:49:29,734 - DEBUG - Fitting page width to view\n2025-05-18 22:49:29,734 - DEBUG - Fitting page width to view: 1182\njs: Invalid page width, using default: 210mm\n2025-05-18 22:49:29,735 - DEBUG - Zoom operation already in progress, skipping update_zoom(141)\n2025-05-18 22:49:29,828 - INFO - Running comprehensive page preview tests...\n2025-05-18 22:49:29,828 - INFO - Testing page count...\n2025-05-18 22:49:29,828 - INFO - Testing navigation...\n2025-05-18 22:49:29,828 - DEBUG - Already at last page, cannot go to next page\n2025-05-18 22:49:29,828 - DEBUG - Already at first page, cannot go to previous page\n2025-05-18 22:49:29,828 - DEBUG - Going to page 3\n2025-05-18 22:49:29,828 - WARNING - Page number 3 exceeds total pages 0, setting to 0\n2025-05-18 22:49:29,828 - INFO - Testing zoom...\n2025-05-18 22:49:29,828 - INFO - Original zoom factor: 1.0\n2025-05-18 22:49:29,828 - INFO - Zoom factor after zoom in: 1.1\n2025-05-18 22:49:29,828 - INFO - Zoom factor after zoom out: 1.0\n2025-05-18 22:49:29,828 - INFO - Zoom factor after reset: 1.0\n2025-05-18 22:49:29,828 - INFO - Testing margin changes...\n2025-05-18 22:49:29,828 - INFO - Original margins: {'top': 25, 'right': 25, 'bottom': 25, 'left': 25}\n2025-05-18 22:49:29,828 - DEBUG - Updating document settings\n2025-05-18 22:49:29,828 - DEBUG - Page dimensions: A4 portrait, 210mm x 297mm\n2025-05-18 22:49:29,828 - DEBUG - Margins: T:10mm R:10mm B:10mm L:10mm\n2025-05-18 22:49:29,828 - DEBUG - Verifying document settings\n2025-05-18 22:49:29,828 - DEBUG - Executing page setup sequence (first load: False)\n2025-05-18 22:49:29,828 - DEBUG - Page setup sequence already in progress, skipping\n2025-05-18 22:49:29,828 - INFO - Changed margins to: {'top': 10, 'right': 10, 'bottom': 10, 'left': 10}\n2025-05-18 22:49:29,828 - DEBUG - Updating document settings\n2025-05-18 22:49:29,828 - DEBUG - Page dimensions: A4 portrait, 210mm x 297mm\n2025-05-18 22:49:29,828 - DEBUG - Margins: T:25mm R:25mm B:25mm L:25mm\n2025-05-18 22:49:29,828 - DEBUG - Verifying document settings\n2025-05-18 22:49:29,828 - DEBUG - Executing page setup sequence (first load: False)\n2025-05-18 22:49:29,828 - DEBUG - Page setup sequence already in progress, skipping\n2025-05-18 22:49:29,828 - INFO - Restored margins to: {'top': 25, 'right': 25, 'bottom': 25, 'left': 25}\n2025-05-18 22:49:29,828 - INFO - Testing page size changes...\n2025-05-18 22:49:29,829 - INFO - Original page size: A4\n2025-05-18 22:49:29,829 - DEBUG - Updating document settings\n2025-05-18 22:49:29,829 - DEBUG - Page dimensions: Letter portrait, 215.9mm x 279.4mm\n2025-05-18 22:49:29,829 - DEBUG - Margins: T:25mm R:25mm B:25mm L:25mm\n2025-05-18 22:49:29,829 - DEBUG - Verifying document settings\n2025-05-18 22:49:29,829 - DEBUG - Executing page setup sequence (first load: False)\n2025-05-18 22:49:29,829 - DEBUG - Page setup sequence already in progress, skipping\n2025-05-18 22:49:29,829 - INFO - Changed page size to: Letter\n2025-05-18 22:49:29,829 - DEBUG - Updating document settings\n2025-05-18 22:49:29,829 - DEBUG - Page dimensions: A4 portrait, 210mm x 297mm\n2025-05-18 22:49:29,829 - DEBUG - Margins: T:25mm R:25mm B:25mm L:25mm\n2025-05-18 22:49:29,829 - DEBUG - Verifying document settings\n2025-05-18 22:49:29,829 - DEBUG - Executing page setup sequence (first load: False)\n2025-05-18 22:49:29,829 - DEBUG - Page setup sequence already in progress, skipping\n2025-05-18 22:49:29,829 - INFO - Restored page size to: A4\n2025-05-18 22:49:29,829 - INFO - Testing orientation changes...\n2025-05-18 22:49:29,829 - INFO - Original orientation: portrait\n2025-05-18 22:49:29,830 - DEBUG - Updating document settings\n2025-05-18 22:49:29,830 - DEBUG - Page dimensions: A4 landscape, 297mm x 210mm\n2025-05-18 22:49:29,830 - DEBUG - Margins: T:25mm R:25mm B:25mm L:25mm\n2025-05-18 22:49:29,830 - DEBUG - Verifying document settings\n2025-05-18 22:49:29,830 - DEBUG - Executing page setup sequence (first load: False)\n2025-05-18 22:49:29,830 - DEBUG - Page setup sequence already in progress, skipping\n2025-05-18 22:49:29,830 - INFO - Changed orientation to: landscape\n2025-05-18 22:49:29,830 - DEBUG - Updating document settings\n2025-05-18 22:49:29,830 - DEBUG - Page dimensions: A4 portrait, 210mm x 297mm\n2025-05-18 22:49:29,830 - DEBUG - Margins: T:25mm R:25mm B:25mm L:25mm\n2025-05-18 22:49:29,830 - DEBUG - Verifying document settings\n2025-05-18 22:49:29,830 - DEBUG - Executing page setup sequence (first load: False)\n2025-05-18 22:49:29,830 - DEBUG - Page setup sequence already in progress, skipping\n2025-05-18 22:49:29,830 - INFO - Restored orientation to: portrait\n2025-05-18 22:49:29,830 - INFO - Debugging page layout\n2025-05-18 22:49:29,830 - DEBUG - Executing JavaScript:\n\n        (function() {\n            try {\n                // Add debug class to body\n                document.body.classList.add('debug-mode');\n\n                // Add visual markers to all pages\n                var pages = document.querySelectorAll('.page');\n                console.log('Found ' + pages.length + ' pages for debugging');\n\n                for (var i = 0; i < pages.length; i++) {\n                    var page = pages[i];\n\n                    // Add debug class\n                    page.classList.add('debug-page');\n\n                    // Add page number for debugging\n                    var pageNum = document.createElement('div');\n                    pageNum.className = 'debug-page-number';\n                    pageNum.textContent = 'Page ' + (i + 1);\n                    pageNum.style.position = 'absolute';\n                    pageNum.style.top = '5px';\n                    pageNum.style.right = '5px';\n                    pageNum.style.backgroundColor = 'rgba(255, 0, 0, 0.7)';\n                    pageNum.style.color = 'white';\n                    pageNum.style.padding = '2px 5px';\n                    pageNum.style.fontSize = '12px';\n                    pageNum.style.zIndex = '1000';\n                    page.appendChild(pageNum);\n\n                    // Highlight margin box\n                    var marginBox = page.querySelector('.margin-box');\n                    if (marginBox) {\n                        marginBox.style.border = '2px dashed rgba(255, 0, 0, 0.7)';\n                        marginBox.style.backgroundColor = 'rgba(255, 0, 0, 0.05)';\n                    }\n\n                    // Log page dimensions\n                    var rect = page.getBoundingClientRect();\n                    console.log('Page ' + (i + 1) + ' dimensions: ' +\n                                rect.width + 'px x ' + rect.height + 'px');\n                }\n\n                // Log document settings\n                console.log('Document settings debug info:');\n                console.log('- Viewport width: ' + window.innerWidth + 'px');\n                console.log('- Viewport height: ' + window.innerHeight + 'px');\n                console.log('- Device pixel ratio: ' + window.devicePixelRatio);\n\n                return 'Debug markers added to ' + pages.length + ' pages';\n            } catch (e) {\n                console.error('Error in debug_page_layout:', e);\n                return 'Error: ' + e.message;\n            }\n        })();\n        \n2025-05-18 22:49:29,830 - INFO - Page count: 1\n2025-05-18 22:49:29,830 - INFO - Current page after next: 1\n2025-05-18 22:49:29,830 - INFO - Current page after previous: 1\n2025-05-18 22:49:29,830 - DEBUG - Page navigation result: Navigated to page 1 of 1\n2025-05-18 22:49:29,830 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:29,831 - INFO - Current page after go_to_page(3): 1\n2025-05-18 22:49:29,933 - DEBUG - Executing operation: final_verification\n2025-05-18 22:49:30,036 - DEBUG - JavaScript execution result: Debug markers added to 1 pages\n2025-05-18 22:49:30,036 - INFO - Debug page layout result: Debug markers added to 1 pages\n2025-05-18 22:49:30,036 - INFO - Comprehensive page preview tests completed\n2025-05-18 22:49:30,036 - DEBUG - Page load verification result: {'bodyContent': 18548, 'documentReady': True, 'title': 'Markdown Preview'}\n2025-05-18 22:49:30,036 - DEBUG - Page loaded correctly\n2025-05-18 22:49:30,036 - DEBUG - Clearing setup flags\n2025-05-18 22:49:30,039 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:30,039 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:30,039 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:30,039 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:31,041 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:31,041 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:31,041 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:31,042 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:31,335 - DEBUG - Verifying page setup\n2025-05-18 22:49:31,335 - DEBUG - Page verification result: Verified 1 pages\n2025-05-18 22:49:32,043 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:32,043 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:32,044 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:32,044 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:33,045 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:33,045 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:33,046 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:33,046 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:34,047 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:34,047 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:34,047 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:34,047 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:35,049 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:35,049 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:35,050 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:35,050 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:35,584 - DEBUG - Zoom in\n2025-05-18 22:49:35,584 - DEBUG - Updating zoom to value: 110\n2025-05-18 22:49:35,585 - DEBUG - Setting zoom factor to 1.1\n2025-05-18 22:49:35,589 - DEBUG - Zoom update result: Zoom applied to pages\n2025-05-18 22:49:36,051 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:36,052 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:36,052 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:36,052 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:36,073 - DEBUG - Zoom in\n2025-05-18 22:49:36,073 - DEBUG - Updating zoom to value: 120\n2025-05-18 22:49:36,073 - DEBUG - Zoom operation already in progress, skipping\n2025-05-18 22:49:36,513 - DEBUG - Zoom in\n2025-05-18 22:49:36,513 - DEBUG - Updating zoom to value: 130\n2025-05-18 22:49:36,513 - DEBUG - Setting zoom factor to 1.3\n2025-05-18 22:49:36,518 - DEBUG - Zoom update result: Zoom applied to pages\n2025-05-18 22:49:36,722 - DEBUG - Zoom in\n2025-05-18 22:49:36,723 - DEBUG - Updating zoom to value: 140\n2025-05-18 22:49:36,723 - DEBUG - Zoom operation already in progress, skipping\n2025-05-18 22:49:37,053 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:37,053 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:37,053 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:37,053 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:37,592 - DEBUG - Fitting page to view\n2025-05-18 22:49:37,593 - DEBUG - Fitting page to view: 1182x704\n2025-05-18 22:49:37,594 - DEBUG - Zoom operation already in progress, skipping update_zoom(150)\n2025-05-18 22:49:38,054 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:38,054 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:38,056 - DEBUG - Page count update result: {'currentPage': 1, 'totalPages': 1}\n2025-05-18 22:49:38,056 - DEBUG - Updating page counter: 1 of 1\n2025-05-18 22:49:38,138 - DEBUG - Fitting page to view\n2025-05-18 22:49:38,138 - DEBUG - Fitting page to view: 1182x704\n2025-05-18 22:49:38,138 - DEBUG - Zoom operation already in progress, skipping update_zoom(150)\n2025-05-18 22:49:38,479 - DEBUG - Fitting page to view\n2025-05-18 22:49:38,479 - DEBUG - Zoom operation already in progress, skipping fit_to_page\n2025-05-18 22:49:38,863 - DEBUG - Fitting page width to view\n2025-05-18 22:49:38,863 - DEBUG - Fitting page width to view: 1182\n2025-05-18 22:49:38,863 - DEBUG - Zoom operation already in progress, skipping update_zoom(150)\n",
    "duration": 10.867434978485107,
    "timestamp": "2025-05-18T22:49:39.043362",
    "category": "page_preview",
    "performance_metrics": {}
  },
  {
    "name": "page_preview.test_js_syntax_and_page_numbers.py",
    "passed": false,
    "message": "Test failed with return code 1",
    "details": "STDOUT:\n2025-05-18 22:49:39,193 - INFO - Logging to file: C:\\Users\\joshd\\.markdown_pdf_logs\\markdown_pdf_debug_20250518_224939.log\n2025-05-18 22:49:39,215 - INFO - Running all tests\n2025-05-18 22:49:39,215 - INFO - Running all JavaScript and page number tests\n2025-05-18 22:49:39,215 - INFO - Testing for JavaScript syntax errors\n2025-05-18 22:49:41,672 - ERROR - Error running tests: 'PagePreview' object has no attribute 'initialize_page_count'\n2025-05-18 22:49:41,675 - ERROR - Traceback (most recent call last):\n  File \"C:\\Projects\\markdown2pdf\\test_js_syntax_and_page_numbers.py\", line 579, in main\n    success = tester.run_all_tests()\n              ^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Projects\\markdown2pdf\\test_js_syntax_and_page_numbers.py\", line 537, in run_all_tests\n    js_syntax_result = self.test_js_syntax()\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Projects\\markdown2pdf\\test_js_syntax_and_page_numbers.py\", line 218, in test_js_syntax\n    preview.initialize_page_count()\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'PagePreview' object has no attribute 'initialize_page_count'\n\n\n\nSTDERR:\n",
    "duration": 2.697763681411743,
    "timestamp": "2025-05-18T22:49:41.742632",
    "category": "page_preview",
    "performance_metrics": {}
  },
  {
    "name": "page_preview.test_page_navigation_and_export.py",
    "passed": true,
    "message": "Test passed",
    "details": "STDOUT:\n2025-05-18 22:49:41,893 - INFO - Logging to file: C:\\Users\\joshd\\.markdown_pdf_logs\\markdown_pdf_debug_20250518_224941.log\n\n\nSTDERR:\n2025-05-18 22:49:41,914 - INFO - Dialog handler initialized\n2025-05-18 22:49:41,914 - INFO - Dialog handler started (suppress=False, timeout=10000ms)\n2025-05-18 22:49:41,914 - INFO - Registered custom response for QMessageBox\n2025-05-18 22:49:41,914 - INFO - Running all page navigation and export dialog tests\n2025-05-18 22:49:41,914 - INFO - Testing page navigation\n2025-05-18 22:49:41,914 - INFO - Page navigation test passed\n2025-05-18 22:49:41,914 - INFO - Page navigation test result: PASS\n2025-05-18 22:49:41,914 - INFO - Testing export dialogs\n2025-05-18 22:49:41,914 - INFO - Export dialog test passed\n2025-05-18 22:49:41,914 - INFO - Export dialog test result: PASS\n2025-05-18 22:49:41,914 - INFO - Overall test result: PASS\n2025-05-18 22:49:41,914 - INFO - Dialog handler stopped\n2025-05-18 22:49:41,914 - INFO - Closing all active dialogs (0)\n",
    "duration": 0.1906416416168213,
    "timestamp": "2025-05-18T22:49:41.933777",
    "category": "page_preview",
    "performance_metrics": {}
  }
]